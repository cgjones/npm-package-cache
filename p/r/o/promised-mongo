{"_id":"promised-mongo","_rev":"25-f54019b0271f4c305cbbf055615319a4","name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","dist-tags":{"latest":"1.2.0"},"versions":{"0.9.8":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"version":"0.9.8","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"contributors":[{"name":"Mathias Buus Madsen","email":"mathiasbuus@gmail.com"},{"name":"Ian Jorgensen"},{"name":"Eduardo Sorribas"},{"name":"Taeho Kim"},{"name":"Forbes Lindesay"},{"name":"Robert S."},{"name":"Srirangan"},{"name":"Erkan Yilmaz"},{"name":"Jake Maskiewicz"},{"name":"Bjarke Walling"},{"name":"Tobias Baunbæk"},{"name":"Benedikt Arnold"},{"name":"Kevin McTigue"},{"name":"Gordon Mackenzie-Leigh"}],"dependencies":{"readable-stream":"~1.1.8","mongodb":"1.3.19","q":"~0.9.7"},"scripts":{"test":"node ./tests"},"bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo","_id":"promised-mongo@0.9.8","dist":{"shasum":"2e1e28ef13dbc6709a2a565eac85c550c38e8079","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-0.9.8.tgz"},"_from":".","_npmVersion":"1.3.14","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"0.11.1":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"version":"0.11.1","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},{"name":"Mathias Buus Madsen","email":"mathiasbuus@gmail.com"},{"name":"Ian Jorgensen"},{"name":"Eduardo Sorribas"},{"name":"Taeho Kim"},{"name":"Forbes Lindesay"},{"name":"Robert S."},{"name":"Srirangan"},{"name":"Erkan Yilmaz"},{"name":"Jake Maskiewicz"},{"name":"Bjarke Walling"},{"name":"Tobias Baunbæk"},{"name":"Benedikt Arnold"},{"name":"Kevin McTigue"}],"dependencies":{"readable-stream":"~1.1.8","mongodb":"1.4.0","q":"~0.9.7"},"scripts":{"test":"node ./tests"},"bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo","_id":"promised-mongo@0.11.1","dist":{"shasum":"55e7e409e85c0c24ca6bd4a59011f73a3a0550c8","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-0.11.1.tgz"},"_from":".","_npmVersion":"1.4.3","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"0.12.0":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"version":"0.12.0","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},{"name":"Mathias Buus Madsen","email":"mathiasbuus@gmail.com"},{"name":"Ian Jorgensen"},{"name":"Eduardo Sorribas"},{"name":"Taeho Kim"},{"name":"Forbes Lindesay"},{"name":"Robert S."},{"name":"Srirangan"},{"name":"Erkan Yilmaz"},{"name":"Jake Maskiewicz"},{"name":"Bjarke Walling"},{"name":"Tobias Baunbæk"},{"name":"Benedikt Arnold"},{"name":"Kevin McTigue"}],"dependencies":{"readable-stream":"~1.1.8","mongodb":"^1.4.35","q":"~0.9.7"},"scripts":{"test":"node ./tests"},"gitHead":"6267ffc9498994acc865e3be1b03ed57bebbf610","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@0.12.0","_shasum":"c8e3e0ed31479475b453f2ef707eb39991638aae","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"c8e3e0ed31479475b453f2ef707eb39991638aae","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-0.12.0.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.0.0":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.0.0","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"38ddff2ff67c7a6518f30dad4a808b3519d21ae5","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.0.0","_shasum":"7f30479e5aad8fec5396ae53a98445b1cfef45bd","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"7f30479e5aad8fec5396ae53a98445b1cfef45bd","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.0.0.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.0.1":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.0.1","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"bdd587c968fe7af6bdefd0b08a5ae8f04652bedd","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.0.1","_shasum":"4ed157558f1abea96cdf7e7bd4cfe50a68d27715","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"4ed157558f1abea96cdf7e7bd4cfe50a68d27715","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.0.1.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.1.0":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.1.0","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"dbf96041c36dae724692edf0a44b5d73657db9dd","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.1.0","_shasum":"4ce748fdc3e411ec4b2274375ceb22bf03bad1bd","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"4ce748fdc3e411ec4b2274375ceb22bf03bad1bd","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.1.0.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.1.1":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.1.1","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"4b0e7e99679a8557e5e402636290ee5eb5b3fcce","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.1.1","_shasum":"c693a649b8c6379cf4fe5357eddeb80fd196f7ea","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"c693a649b8c6379cf4fe5357eddeb80fd196f7ea","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.1.1.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.1.2":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.1.2","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","harmony-proxy":"0.0.2","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"965545a1e6fc0b8cba3131533594cf8c88382424","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.1.2","_shasum":"96ffa064d0e3e81348173c5877366f7acadf6207","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"96ffa064d0e3e81348173c5877366f7acadf6207","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.1.2.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.1.3":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.1.3","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","harmony-proxy":"0.0.2","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"ad28c094dde67ab1ed3ed22ab055969d1b22dfbe","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.1.3","_shasum":"0cd9b672d01c72d8783aa312cccdabe5f5bc3a81","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"0cd9b672d01c72d8783aa312cccdabe5f5bc3a81","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.1.3.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.1.4":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.1.4","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","harmony-proxy":"0.0.2","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"cde3bff089e35504175923e0d89fd66b6d82d55d","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.1.4","_shasum":"f6e081126f172e8acadde1836a8f78d662e78347","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"f6e081126f172e8acadde1836a8f78d662e78347","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.1.4.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}},"1.2.0":{"name":"promised-mongo","description":"Easy to use module that implements the mongo api and supports promises","keywords":["mongo","db","mongodb","promise","q"],"license":"MIT","version":"1.2.0","repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"dependencies":{"babel-runtime":"^5.5.5","bluebird":"^2.9.27","harmony-proxy":"0.0.2","lodash":"^3.9.3","mongodb-core":"^1.1.33","parse-mongo-url":"^1.1.0","readable-stream":"~1.1.8"},"scripts":{"test":"mocha","main":"dist/index.js"},"devDependencies":{"babel":"^5.5.5","chai":"^3.0.0","grunt":"^0.4.5","grunt-babel":"^5.0.1","grunt-contrib-clean":"^0.6.0","load-grunt-tasks":"^3.2.0"},"gitHead":"a1366a3a025b24ab33dde906fdb1c362388b1fb1","bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","_id":"promised-mongo@1.2.0","_shasum":"57404dec9cb6a61fd6c2973e008089459f688439","_from":".","_npmVersion":"2.10.1","_nodeVersion":"0.12.4","_npmUser":{"name":"gordonml","email":"gordon@stugo.co.uk"},"dist":{"shasum":"57404dec9cb6a61fd6c2973e008089459f688439","tarball":"http://registry.npmjs.org/promised-mongo/-/promised-mongo-1.2.0.tgz"},"maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"directories":{}}},"readme":"<a href=\"http://promises-aplus.github.com/promises-spec\">\n    <img src=\"http://promises-aplus.github.com/promises-spec/assets/logo-small.png\"\n         align=\"right\" alt=\"Promises/A+ logo\" />\n</a>\n\n# promised-mongo\n\nA complete rewrite of [mongojs](https://github.com/mafintosh/mongojs) to support promises.  In a\nbreak with previous versions, this library only supports promises, and not callbacks.\n\n\n## Install\n\npromised-mongo is available through [npm](http://npmjs.org):\n\n\tnpm install promised-mongo\n\n\n## Compatability with previous versions\n\nI no longer use [Q](https://github.com/kriskowal/q) for promises.  This means that you can't  use\n`.done()` at the end of promise chains.  To turn on compatability with previous versions, you can\ncall the `compatible()` function:\n\n```js\nvar pmongo = require('promised-mongo').compatible();\n```\n\nOther than dropping support for callbacks, I have tried to make sure that the new library is\ncompatible with the old tests (see the legacy_tests folder).\n\n\n## How I write JavaScript\n\nI like using [async functions](https://github.com/lukehoban/ecmascript-asyncawait) from current\nEMCAScript proposals.  This makes node amazingly easier to understand.  An example from the tests:\n\n```js\nit('returns all documents', async function () {\n  let docs = [{hello: 'world'}, {hello: 'kitty'}];\n  await collection.insert(docs);\n  let cursor = collection.find();\n  expect(cursor).to.be.an.instanceof(Cursor);\n  let result = await cursor.toArray();\n  expect(result).to.deep.have.members(docs);\n});\n```\n\nIsn't it so much easier to understand?  The downsides (of course there had to be some) is that since\nthis is so bleeding edge, editor support and debugging support are varied and patchy, and there's a\nchance that the feature won't even make it to the final language specification.\n\nThis is compiled to ES5 using [babel](https://babeljs.io/).\n\n\n## Documentation\n\nThe documentation below refers to an older version.  Most of it should still work the same however.\nWatch this space for improvements.\n\n\n## Usage\n\nUse promised-mongo just like mongojs, except that you use the returned promise instead of a\ncallback.\n\n```js\nvar pmongo = require('promised-mongo');\nvar db = pmongo(connectionString, [collections]);\n```\n\nThe connection string should follow the format desribed in\n[the mongo connection string docs](http://docs.mongodb.org/manual/reference/connection-string/).\nSome examples of this could be:\n\n``` js\n// simple usage for a local db\nvar db = pmongo('mydb', ['mycollection']);\n\n// the db is on a remote server (the port default to mongo)\nvar db = pmongo('example.com/mydb', ['mycollection']);\n\n// we can also provide some credentials\nvar db = pmongo('username:password@example.com/mydb', ['mycollection']);\n\n// connect now, and worry about collections later\nvar db = pmongo('mydb');\nvar mycollection = db.collection('mycollection');\n```\n\nAfter we connected we can query or update the database just how we would using the mongo API with the exception that the functions return\na promise for the result rather than the result itself.  Cursor operations such as `find()` and `sort()` return a **cursor**; to get a\npromise for the result, you have to force evaluation using `toArray()`.  Alternatively, you can just call `then()` on the cursor and it will call `toArray()` for you, returning a promise.  The function `findOne()` returns a promise immediately, not a cursor.\nNote that due to [limitations in the Q promise library](https://github.com/kriskowal/q/#the-end), you should call `.done()` at the end of\nany promise chain you aren't returning, in order to throw any uncaught exceptions.  For brevity, the examples in this readme don't do that.\n\n``` js\n// find everything\ndb.mycollection.find().toArray().then(function(docs){\n\t// docs is an array of all the documents in mycollection\n});\n\n// find everything, but sort by name\ndb.mycollection.find().sort({name:1}).toArray().then(function(docs) {\n\t// docs is now a sorted array\n});\n\n// find a document using a native ObjectId\ndb.mycollection.findOne({\n\t_id: pmongo.ObjectId('523209c4561c640000000001')\n}).then(function(doc) {\n\t// doc._id.toString() === '523209c4561c640000000001'\n});\n\n// find all named 'mathias' and increment their level\ndb.mycollection.update({name:'mathias'}, {$inc:{level:1}}, {multi:true})\n\t.then(function(lastErrorObject) {\n\t\t// the update is complete\n\t});\n\n// find one named 'mathias', tag him as a contributor and return the modified doc\ndb.mycollection.findAndModify({\n\tquery: { name: 'mathias' },\n\tupdate: { $set: { tag:'maintainer' } },\n\tnew: true\n})\n.then(function(doc) {\n\t// doc.tag === 'maintainer'\n});\n\n// use the save function to just save a document\ndb.mycollection.save({created:'just now'});\n\n```\n\nThe `forEach` function is a special case.  The library supports the mongojs style:\n\n``` js\n// iterate over all whose level is greater than 90.\ndb.mycollection.find({level:{$gt:90}}).forEach(function(err, doc) {\n\tif (doc) {\n      //do things with doc\n    } else {\n      //the callback gets called at the end with a null doc\n      console.log('Finished!');\n    }\n});\n```\n\nIt also supports a promise version.  If you pass a callback to the `forEach` function with only one argument, you get the promise version.  The promise will resolve (with `undefined`) when the callback has been called for all documents.\n\n``` js\n// iterate over all whose level is greater than 90 (promise version)\ndb.mycollection.find({level:{$gt:90}}).forEach(function(doc) {\n\t//do things with doc\n})\n.then(function () {\n  console.log('Finished!');\n});\n```\n\nTo access `lastErrorObject` returned by `findAndModify` using the promises API, use the `findAndModifyEx` function:\n\n```\ndb.mycollection.findAndModifyEx({\n\tquery: { name: 'mathias' },\n\tupdate: { $set: { tag:'maintainer' } },\n\tnew: true\n})\n.then(function(result) {\n\tvar doc = result.result;\n\tvar lastErrorObject = result.lastErrorObject;\n});\n```\n\nIf you provide a callback to `find` or any cursor config operation mongojs will call `toArray` for you\n\n``` js\ndb.mycollection.find({}, function(err, docs) { ... });\n\ndb.mycollection.find({}).limit(2).skip(1, function(err, docs) { ... });\n```\nis the same as\n\n``` js\ndb.mycollection.find({}).toArray(function(err, docs) { ... });\n\ndb.mycollection.find({}).limit(2).skip(1).toArray(function(err, docs) { ... });\n```\n\nIf you are using the promises API, **you must call toArray() on cursors** before a promise can be obtained.  E.g.:\n\n```\ndb.mycollection.find().limit(2).skip(1).toArray()\n\t.then(function (docs) {\n\t\t// ...\n\t});\n```\n\nFor more detailed information about the different usages of update and querying see [the mongo docs](http://www.mongodb.org/display/DOCS/Manual)\n\n## Streaming cursors\n\nAs of `0.7.0` all cursors are a [readable stream](http://nodejs.org/api/stream.html#stream_readable_stream) of objects.\n\n``` js\nvar JSONStream = require('JSONStream');\n\n// pipe all documents in mycollection to stdout\ndb.mycollection.find({}).pipe(JSONStream.stringify()).pipe(process.stdout);\n```\n\nNotice that you should pipe the cursor through a stringifier (like [JSONStream](https://github.com/dominictarr/JSONStream))\nif you want to pipe it to a serial stream like a http response.\n\n## Tailable cursors\n\nIf you are using a capped collection you can create a [tailable cursor](http://docs.mongodb.org/manual/tutorial/create-tailable-cursor/) to that collection by adding `tailable:true` to the find options\n\n``` js\nvar cursor = db.mycollection.find({}, {}, {tailable:true, timeout:false});\n\n// since all cursors are streams we can just listen for data\ncursor.on('data', function(doc) {\n\tconsole.log('new document', doc);\n});\n```\n\nNote that you need to explicitly set the selection parameter in the `find` call.\n\n## Database commands\n\nWith promised-mongo you can run database commands just like with the mongo shell using `db.runCommand()`\n\n```js\ndb.runCommand({ping:1}).then(function(res) {\n\tif(res.ok) console.log(\"we're up\");\n}).catch(function(err){\n\tif(err) console.log(\"we aren't up\", err);\n});\n```\n\nor `db.collection.runCommand()`\n\n```js\ndb.things.runCommand('count').then(function(res) {\n\tconsole.log(res);\n});\n```\n\n## Replication Sets\n\nPromised-mongo can also connect to a mongo replication set by providing a connection string with multiple hosts\n\n``` js\nvar db = pmongo('rs-1.com,rs-2.com,rs-3.com/mydb?slaveOk=true', ['mycollection']);\n```\n\nFor more detailed information about replica sets see [the mongo replication docs](http://www.mongodb.org/display/DOCS/Replica+Sets)\n\n# API\n\nThis API documentation is a work in progress.  To maintain compatibility with mongojs,\nall functions can accept a callback.  If no callback is specified, a promise is returned.\n\n#### Collection\n\n#####`db.collection.aggregate([pipeline], callback)`\n\n#####`db.collection.count([query], callback)`\n\n#####`db.collection.createIndex(keys, options, [callback])`\n\n#####`db.collection.distinct(field, query, callback)`\n\n#####`db.collection.drop([callback])`\n\n#####`db.collection.dropIndex(index, [callback])`\n\n#####`db.collection.dropIndexes([callback])`\n\n#####`db.collection.ensureIndex(keys, options, [callback])`\n\n#####`db.collection.find([criteria], [projection], [callback])`\n\nThis function applies a query to a collection. You can get the return value, which is a cursor, or pass a callback\nas the last parameter. Said callback receives `(err, documents)`\n\n#####`db.collection.findOne([criteria], [projection], callback)`\n\nApply a query and get one single document passed as a callback. The callback receives `(err, document)`\n\n#####`db.collection.findAndModify(document, callback)`\n\n#####`db.collection.getIndexes(callback)`\n\n#####`db.collection.group(document, callback)`\n\n#####`db.collection.insert(docOrDocs, callback)`\n\n#####`db.collection.isCapped(callback)`\n\n#####`db.collection.mapReduce(map, reduce, options, callback)`\n\n#####`db.collection.reIndex(callback)`\n\n#####`db.collection.remove(query, [justOne], [callback])`\n\n#####`db.collection.runCommand(command, callback)`\n\n#####`db.collection.save(doc, callback)`\n\n#####`db.collection.stats(callback)`\n\n#####`db.collection.update(query, update, [options], callback)`\n\n#### Cursor\n\n#####`cursor.batchSize(size, [callback])`\n\n#####`cursor.count(callback)`\n\n#####`cursor.explain(callback)`\n\n#####`cursor.forEach(function)`\n\n#####`cursor.limit(n, [callback])`\n\n#####`cursor.map(function, [callback])`\n\n#####`cursor.next(callback)`\n\n#####`cursor.skip(n, [callback])`\n\n#####`cursor.sort(sortOptions, [callback])`\n\n#####`cursor.toArray(callback)`\n\n#### Database\n\n#####`db.addUser(document)`\n\n#####`db.createCollection(name, options, [callback])`\n\n#####`db.dropDatabase([callback])`\n\n#####`db.eval(function, arguments)`\n\n#####`db.getCollectionNames([callback])`\n\n#####`db.getLastError([callback])`\n\n#####`db.getLastErrorObj([callback])`\n\n#####`db.removeUser(username, [callback])`\n\n#####`db.runCommand(command, [callback])`\n\n#####`db.stats([callback])`\n","maintainers":[{"name":"gordonml","email":"gordon@stugo.co.uk"}],"time":{"modified":"2015-07-02T08:46:58.272Z","created":"2013-11-30T15:12:12.998Z","0.9.8":"2013-11-30T15:12:16.798Z","0.11.1":"2014-04-20T12:26:37.106Z","0.12.0":"2015-06-16T14:35:34.612Z","1.0.0":"2015-06-16T14:55:00.851Z","1.0.1":"2015-06-16T15:24:17.198Z","1.1.0":"2015-06-23T09:26:44.232Z","1.1.1":"2015-06-23T09:58:18.643Z","1.1.2":"2015-06-26T11:22:05.679Z","1.1.3":"2015-07-01T16:45:11.571Z","1.1.4":"2015-07-01T16:53:57.225Z","1.2.0":"2015-07-02T08:46:58.272Z"},"repository":{"type":"git","url":"git://github.com/gordonmleigh/promised-mongo.git"},"users":{"rudyschockaert":true,"jedsmithobd":true,"brubrant":true,"parkerproject":true,"peng.jiesi":true,"brightchen":true,"zhoutk":true},"homepage":"https://github.com/gordonmleigh/promised-mongo#readme","keywords":["mongo","db","mongodb","promise","q"],"contributors":[{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"}],"author":{"name":"Gordon Mackenzie-Leigh","email":"gordon@stugo.co.uk"},"bugs":{"url":"https://github.com/gordonmleigh/promised-mongo/issues"},"readmeFilename":"README.md","license":"MIT","_attachments":{}}